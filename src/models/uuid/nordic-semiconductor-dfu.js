/*
* This module exports the uuid that identifies the nordic semicondutors
device firmware update Service and Characteristics

* The Services and Characteristics UUID are generated by replacing the 12,13
* octet with a uniqe id.
*/

/*

*/
const NordicButtonlessDFUBaseUUID = "8E40xxxx-F315-4F60-9FB8-838830DAEA50"

/*

*/
const NordicButtonlessDFUIdentifiers = {
  ServiceAndControlPoint: "0001"
};

const DFU_BASE = '0000xxxx-0000-1000-8000-00805f9b34fb'
const DFU_CHAR_BASE = '8ec9xxxx-f315-4f60-9fb8-838830daea50'

const DFUIdentifiers = {
  // DFU by Nordic Semiconductor
  DFUSecure: "FE59",
  // Control Point is notify, write
  DFUSecureControlPoint: "0001",
  // Packet is Write No Response
  DFUSecurePacketPoint: "0002",
}

const GetUUID = function(identifier,baseuuid) {
  var index = baseuuid.indexOf('xx');
  var uuidString = baseuuid.substring(0,index) + identifier.substring(0,2) + baseuuid.substring(index+2,baseuuid.length);
  index = uuidString.indexOf('xx')
  uuidString = uuidString.substring(0,index) + identifier.substring(2,4) + uuidString.substring(index+2,uuidString.length);
  return uuidString;
}

export const NordicSemiconductorServices = {
  DFU: GetUUID(DFUIdentifiers.DFUSecure,DFU_BASE).toLowerCase(),
  Buttonless: GetUUID(NordicButtonlessDFUIdentifiers.ServiceAndControlPoint,NordicButtonlessDFUBaseUUID).toLowerCase()
}

export const NordicSemiconductorCharacteristics = {
  ControlPoint: GetUUID(DFUIdentifiers.DFUSecureControlPoint,DFU_CHAR_BASE).toLowerCase(),
  PacketPoint: GetUUID(DFUIdentifiers.DFUSecurePacketPoint,DFU_CHAR_BASE).toLowerCase(),
  Buttonless: GetUUID(NordicButtonlessDFUIdentifiers.ServiceAndControlPoint,NordicButtonlessDFUBaseUUID).toLowerCase()
}
