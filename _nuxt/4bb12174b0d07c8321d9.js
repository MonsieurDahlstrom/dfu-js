(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{192:function(t,e,n){"use strict";(function(t,r,o){n.d(e,"a",function(){return Fn}),n.d(e,"b",function(){return Bn}),n.d(e,"c",function(){return At}),n.d(e,"d",function(){return On});n(123),n(228),n(49),n(124),n(46),n(70),n(91),n(230),n(94),n(95),n(231),n(232),n(125);var c=n(277),f=n(233),h=(n(234),n(278)),l=n(235),v=n(236),d=(n(71),n(48),n(41),n(67),n(68),n(237));n(238),n(22);function y(t,e,n,r,o,c,f){try{var h=t[c](f),l=h.value}catch(t){return void n(t)}h.done?e(l):Promise.resolve(l).then(r,o)}function m(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var c=t.apply(e,n);function f(t){y(c,r,o,f,h,"next",t)}function h(t){y(c,r,o,f,h,"throw",t)}f(void 0)})}}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e,n){return e&&k(t.prototype,e),n&&k(t,n),t}function E(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,p){return(A=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t})(t,p)}function C(t,e){return!e||"object"!==Object(d.a)(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}var P,S="function"==typeof t&&t,O="object"===(void 0===r?"undefined":Object(d.a)(r))&&"function"==typeof r.nextTick;function R(t){setTimeout(t,0)}P=S?t:O?r.nextTick:R;var I,T=(I=P,function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return I(function(){return t.apply(void 0,n)})});function D(t){return U(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.pop();return B(t.apply(this,n),o)}:(e=function(e,n){var r;try{r=t.apply(this,e)}catch(t){return n(t)}if(r&&"function"==typeof r.then)return B(r,n);n(null,r)},function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n.pop();return e.call(this,n,o)});var e}function B(t,e){return t.then(function(t){F(e,null,t)},function(t){F(e,t&&t.message?t:new Error(t))})}function F(t,e,n){try{t(e,n)}catch(t){T(function(t){throw t},t)}}function U(t){return"AsyncFunction"===t[Symbol.toStringTag]}function L(t){if("function"!=typeof t)throw new Error("expected a function");return U(t)?D(t):t}function j(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(!e)throw new Error("arity is undefined");function n(){for(var n=this,r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return"function"==typeof o[e-1]?t.apply(this,o):new Promise(function(r,c){o[e-1]=function(t){if(t)return c(t);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];r(n.length>1?n:n[0])},t.apply(n,o)})}return Object.defineProperty(n,"name",{value:"awaitable(".concat(t.name,")")}),n}function N(t,e,n,r){e=e||[];var o=[],c=0,f=L(n);return t(e,function(t,e,n){var r=c++;f(t,function(t,e){o[r]=e,n(t)})},function(t){r(t,o)})}function M(t){return t&&"number"==typeof t.length&&t.length>=0&&t.length%1==0}var Y={};function z(t){function e(){if(null!==t){var e=t;t=null;for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e.apply(this,r)}}return Object.assign(e,t),e}function $(t){if(M(t))return function(t){var i=-1,e=t.length;return function(){return++i<e?{value:t[i],key:i}:null}}(t);var e,n,i,r,o=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()}(t);return o?function(t){var i=-1;return function(){var e=t.next();return e.done?null:(i++,{value:e.value,key:i})}}(o):(n=(e=t)?Object.keys(e):[],i=-1,r=n.length,function(){var t=n[++i];return i<r?{value:e[t],key:t}:null})}function G(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null;for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e.apply(this,r)}}function V(t,e,n,r){var o=!1,c=!1,f=!1,h=0,l=0;function v(){h>=e||f||o||(f=!0,t.next().then(function(t){var e=t.value,y=t.done;if(!c&&!o){if(f=!1,y)return o=!0,void(h<=0&&r(null));h++,n(e,l,d),l++,v()}}).catch(y))}function d(t,e){if(h-=1,!c)return t?y(t):!1===t?(o=!0,void(c=!0)):e===Y||o&&h<=0?(o=!0,r(null)):void v()}function y(t){c||(f=!1,o=!0,r(t))}v()}var W=function(t){return function(e,n,r){if(r=z(r),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return r(null);if("AsyncGenerator"===e[Symbol.toStringTag])return V(e,t,n,r);if(function(t){return"function"==typeof t[Symbol.asyncIterator]}(e))return V(e[Symbol.asyncIterator](),t,n,r);var o=$(e),c=!1,f=!1,h=0,l=!1;function v(t,e){if(!f)if(h-=1,t)c=!0,r(t);else if(!1===t)c=!0,f=!0;else{if(e===Y||c&&h<=0)return c=!0,r(null);l||d()}}function d(){for(l=!0;h<t&&!c;){var e=o();if(null===e)return c=!0,void(h<=0&&r(null));h+=1,n(e.value,e.key,G(v))}l=!1}d()}};var J=j(function(t,e,n,r){return W(e)(t,L(n),r)},4);function H(t,e,n){n=z(n);var r=0,o=0,c=t.length,f=!1;function h(t,e){!1===t&&(f=!0),!0!==f&&(t?n(t):++o!==c&&e!==Y||n(null))}for(0===c&&n(null);r<c;r++)e(t[r],r,G(h))}function Q(t,e,n){return J(t,1/0,e,n)}var Z=j(function(t,e,n){return(M(t)?H:Q)(t,L(e),n)},3);var K=j(function(t,e,n){return N(Z,t,e,n)},3);var X=j(function(t,e,n){return J(t,1,e,n)},3);j(function(t,e,n){return N(X,t,e,n)},3);var tt=function(){function t(){Object(l.a)(this,t),this.head=this.tail=null,this.length=0}return Object(v.a)(t,[{key:"removeLink",value:function(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t}},{key:"empty",value:function(){for(;this.head;)this.shift();return this}},{key:"insertAfter",value:function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1}},{key:"insertBefore",value:function(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1}},{key:"unshift",value:function(t){this.head?this.insertBefore(this.head,t):et(this,t)}},{key:"push",value:function(t){this.tail?this.insertAfter(this.tail,t):et(this,t)}},{key:"shift",value:function(){return this.head&&this.removeLink(this.head)}},{key:"pop",value:function(){return this.tail&&this.removeLink(this.tail)}},{key:"toArray",value:function(){return Object(h.a)(this)}},{key:Symbol.iterator,value:regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.head;case 1:if(!e){t.next=7;break}return t.next=4,e.data;case 4:e=e.next,t.next=1;break;case 7:case"end":return t.stop()}},t,this)})},{key:"remove",value:function(t){for(var e=this.head;e;){var n=e.next;t(e)&&this.removeLink(e),e=n}return this}}]),t}();function et(t,e){t.length=1,t.head=t.tail=e}function nt(t,e,n){var r;if(null==e)e=1;else if(0===e)throw new RangeError("Concurrency must not be zero");var o=L(t),c=0,h=[],l={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function v(t,e){return t?e?void(l[t]=l[t].filter(function(t){return t!==e})):l[t]=[]:Object.keys(l).forEach(function(t){return l[t]=[]})}function d(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];l[t].forEach(function(t){return t.apply(void 0,n)})}var y=!1;function m(data,t,e){if(null!=e&&"function"!=typeof e)throw new Error("task callback must be a function");var n;q.started=!0;var r={data:data,callback:e||function(t){if(!t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];if(r.length<=1)return n(r[0]);n(r)}}};if(t?q._tasks.unshift(r):q._tasks.push(r),y||(y=!0,T(function(){y=!1,q.process()})),!e)return new Promise(function(t){n=t})}function w(t){return function(e){c-=1;for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(var i=0,f=t.length;i<f;i++){var l=t[i],v=h.indexOf(l);0===v?h.shift():v>0&&h.splice(v,1),l.callback.apply(l,[e].concat(r)),null!=e&&d("error",e,l.data)}c<=q.concurrency-q.buffer&&d("unsaturated"),q.idle()&&d("drain"),q.process()}}var k=function(t){return function(e){if(!e)return new Promise(function(e,n){!function(t,e){l[t].push(function n(){v(t,n),e.apply(void 0,arguments)})}(t,function(t,data){if(t)return n(t);e(data)})});v(t),function(t,e){l[t].push(e)}(t,e)}},_=!1,q=(r={_tasks:new tt},Object(f.a)(r,Symbol.iterator,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(q._tasks[Symbol.iterator](),"t0",1);case 1:case"end":return t.stop()}},t)})),Object(f.a)(r,"concurrency",e),Object(f.a)(r,"payload",n),Object(f.a)(r,"buffer",e/4),Object(f.a)(r,"started",!1),Object(f.a)(r,"paused",!1),Object(f.a)(r,"push",function(data,t){return Array.isArray(data)?0===data.length&&q.idle()?T(function(){return d("drain")}):data.map(function(e){return m(e,!1,t)}):m(data,!1,t)}),Object(f.a)(r,"kill",function(){v(),q._tasks.empty()}),Object(f.a)(r,"unshift",function(data,t){return Array.isArray(data)?0===data.length&&q.idle()?T(function(){return d("drain")}):data.map(function(e){return m(e,!0,t)}):m(data,!0,t)}),Object(f.a)(r,"remove",function(t){q._tasks.remove(t)}),Object(f.a)(r,"process",function(){if(!_){for(_=!0;!q.paused&&c<q.concurrency&&q._tasks.length;){var t=[],data=[],e=q._tasks.length;q.payload&&(e=Math.min(e,q.payload));for(var i=0;i<e;i++){var n=q._tasks.shift();t.push(n),h.push(n),data.push(n.data)}c+=1,0===q._tasks.length&&d("empty"),c===q.concurrency&&d("saturated");var r=G(w(t));o(data,r)}_=!1}}),Object(f.a)(r,"length",function(){return q._tasks.length}),Object(f.a)(r,"running",function(){return c}),Object(f.a)(r,"workersList",function(){return h}),Object(f.a)(r,"idle",function(){return q._tasks.length+c===0}),Object(f.a)(r,"pause",function(){q.paused=!0}),Object(f.a)(r,"resume",function(){!1!==q.paused&&(q.paused=!1,T(q.process))}),r);return Object.defineProperties(q,{saturated:{writable:!1,value:k("saturated")},unsaturated:{writable:!1,value:k("unsaturated")},empty:{writable:!1,value:k("empty")},drain:{writable:!1,value:k("drain")},error:{writable:!1,value:k("error")}}),q}j(function(t,e,n,r){r=z(r);var o=L(n);return X(t,function(t,i,n){o(e,t,function(t,r){e=r,n(t)})},function(t){return r(t,e)})},4);var it=j(function(t,e,n,r){return N(W(e),t,n,r)},4);var ot=j(function(t,e,n,r){var o=L(n);return it(t,e,function(t,e){o(t,function(t){if(t)return e(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return e(t,r)})},function(t,e){for(var n=[],i=0;i<e.length;i++){var o;e[i]&&(n=(o=n).concat.apply(o,Object(h.a)(e[i])))}return r(t,n)})},4);j(function(t,e,n){return ot(t,1/0,e,n)},3);j(function(t,e,n){return ot(t,1,e,n)},3);function st(t,e){return function(n,r,o,c){var f,h=!1,l=L(o);n(r,function(n,r,o){l(n,function(r,c){return r||!1===r?o(r):t(c)&&!f?(h=!0,f=e(!0,n),o(null,Y)):void o()})},function(t){if(t)return c(t);c(null,h?f:e(!1))})}}j(function(t,e,n){return st(function(t){return t},function(t,e){return e})(Z,t,e,n)},3);j(function(t,e,n,r){return st(function(t){return t},function(t,e){return e})(W(e),t,n,r)},4);j(function(t,e,n){return st(function(t){return t},function(t,e){return e})(W(1),t,e,n)},3);j(function(t,e,n){n=G(n);var r,o=L(t),c=L(e);function f(t){if(t)return n(t);if(!1!==t){for(var e=arguments.length,o=new Array(e>1?e-1:0),f=1;f<e;f++)o[f-1]=arguments[f];r=o,c.apply(void 0,o.concat([l]))}}function l(t,e){return t?n(t):!1!==t?e?void o(f):n.apply(void 0,[null].concat(Object(h.a)(r))):void 0}return l(null,!0)},3);function at(t){return function(e,n,r){return t(e,r)}}j(function(t,e,n){return Z(t,at(L(e)),n)},3);var ut=j(function(t,e,n,r){return W(e)(t,at(L(n)),r)},4);var ct=j(function(t,e,n){return ut(t,1,e,n)},3);j(function(t,e,n){return st(function(t){return!t},function(t){return!t})(Z,t,e,n)},3);j(function(t,e,n,r){return st(function(t){return!t},function(t){return!t})(W(e),t,n,r)},4);j(function(t,e,n){return st(function(t){return!t},function(t){return!t})(X,t,e,n)},3);function ft(t,e,n,r){var o=new Array(e.length);t(e,function(t,e,r){n(t,function(t,n){o[e]=!!n,r(t)})},function(t){if(t)return r(t);for(var n=[],i=0;i<e.length;i++)o[i]&&n.push(e[i]);r(null,n)})}function ht(t,e,n,r){var o=[];t(e,function(t,e,r){n(t,function(n,c){if(n)return r(n);c&&o.push({index:e,value:t}),r(n)})},function(t){if(t)return r(t);r(null,o.sort(function(a,b){return a.index-b.index}).map(function(t){return t.value}))})}function lt(t,e,n,r){return(M(e)?ft:ht)(t,e,L(n),r)}j(function(t,e,n){return lt(Z,t,e,n)},3);j(function(t,e,n,r){return lt(W(e),t,n,r)},4);j(function(t,e,n){return lt(X,t,e,n)},3);j(function(t,e){var n=G(e),r=L(function(t){return U(t)?t:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.pop(),c=!0;n.push(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];c?T(function(){return o.apply(void 0,e)}):o.apply(void 0,e)}),t.apply(this,n),c=!1}}(t));return function t(e){if(e)return n(e);!1!==e&&r(t)}()},2);j(function(t,e,n,r){var o=L(n);return it(t,e,function(t,e){o(t,function(n,r){return n?e(n):e(n,{key:r,val:t})})},function(t,e){for(var n={},o=Object.prototype.hasOwnProperty,i=0;i<e.length;i++)if(e[i]){var c=e[i].key,f=e[i].val;o.call(n,c)?n[c].push(f):n[c]=[f]}return r(t,n)})},4);j(function(t,e,n,r){r=z(r);var o={},c=L(n);return W(e)(t,function(t,e,n){c(t,e,function(t,r){if(t)return n(t);o[e]=r,n(t)})},function(t){return r(t,o)})},4);O&&r.nextTick;j(function(t,e,n){var r=M(e)?[]:{};t(e,function(t,e,n){L(t)(function(t){for(var o=arguments.length,f=new Array(o>1?o-1:0),h=1;h<o;h++)f[h-1]=arguments[h];if(f.length<2){var l=f;f=Object(c.a)(l,1)[0]}r[e]=f,n(t)})},function(t){return n(t,r)})},3);function vt(t,e){var n=L(t);return nt(function(t,e){n(t[0],e)},e,1)}j(function(t,e){if(e=z(e),!Array.isArray(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var i=0,n=t.length;i<n;i++)L(t[i])(e)},2);function pt(t,e,n,r){var o=L(n);return lt(t,e,function(t,e){o(t,function(t,n){e(t,!n)})},r)}j(function(t,e,n){return pt(Z,t,e,n)},3);j(function(t,e,n,r){return pt(W(e),t,n,r)},4);j(function(t,e,n){return pt(X,t,e,n)},3);j(function(t,e,n){return st(Boolean,function(t){return t})(Z,t,e,n)},3);j(function(t,e,n,r){return st(Boolean,function(t){return t})(W(e),t,n,r)},4);j(function(t,e,n){return st(Boolean,function(t){return t})(X,t,e,n)},3);j(function(t,e,n){var r=L(e);return K(t,function(t,e){r(t,function(n,r){if(n)return e(n);e(n,{value:t,criteria:r})})},function(t,e){if(t)return n(t);n(null,e.sort(o).map(function(t){return t.value}))});function o(t,e){var a=t.criteria,b=e.criteria;return a<b?-1:a>b?1:0}},3);j(function(t,e){var n,r=null;return ct(t,function(t,e){L(t)(function(t){if(!1===t)return e(t);for(var o=arguments.length,c=new Array(o>1?o-1:0),f=1;f<o;f++)c[f-1]=arguments[f];n=c.length<2?c[0]:c,r=t,e(t?null:{})})},function(){return e(r,n)})});j(function(t,e,n){n=G(n);var r=L(e),o=L(t),c=[];function f(t){if(t)return n(t);for(var e=arguments.length,r=new Array(e>1?e-1:0),f=1;f<e;f++)r[f-1]=arguments[f];c=r,!1!==t&&o(l)}function l(t,e){return t?n(t):!1!==t?e?void r(f):n.apply(void 0,[null].concat(Object(h.a)(c))):void 0}return o(l)},3);j(function(t,e){if(e=z(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var n=0;function r(e){L(t[n++]).apply(void 0,Object(h.a)(e).concat([G(o)]))}function o(o){if(!1!==o){for(var c=arguments.length,f=new Array(c>1?c-1:0),h=1;h<c;h++)f[h-1]=arguments[h];if(o||n===t.length)return e.apply(void 0,[o].concat(f));r(f)}}r([])});function gt(){}function yt(){yt.init.call(this)}function mt(t){return void 0===t._maxListeners?yt.defaultMaxListeners:t._maxListeners}function wt(t,e,n,r){var o,c,f,h;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((c=t._events)?(c.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),c=t._events),f=c[e]):(c=t._events=new gt,t._eventsCount=0),f){if("function"==typeof f?f=c[e]=r?[n,f]:[f,n]:r?f.unshift(n):f.push(n),!f.warned&&(o=mt(t))&&o>0&&f.length>o){f.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=f.length,h=l,"function"==typeof console.warn?console.warn(h):console.log(h)}}else f=c[e]=n,++t._eventsCount;return t}function bt(t,e,n){var r=!1;function g(){t.removeListener(e,g),r||(r=!0,n.apply(t,arguments))}return g.listener=n,g}function kt(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function _t(t,i){for(var e=new Array(i);i--;)e[i]=t[i];return e}gt.prototype=Object.create(null),yt.EventEmitter=yt,yt.usingDomains=!1,yt.prototype.domain=void 0,yt.prototype._events=void 0,yt.prototype._maxListeners=void 0,yt.defaultMaxListeners=10,yt.init=function(){this.domain=null,yt.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new gt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},yt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},yt.prototype.getMaxListeners=function(){return mt(this)},yt.prototype.emit=function(t){var e,n,r,o,i,c,f,h="error"===t;if(c=this._events)h=h&&null==c.error;else if(!h)return!1;if(f=this.domain,h){if(e=arguments[1],!f){if(e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=f,e.domainThrown=!1,f.emit("error",e),!1}if(!(n=c[t]))return!1;var v="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,o=_t(t,r),i=0;i<r;++i)o[i].call(n)}(n,v,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var o=t.length,c=_t(t,o),i=0;i<o;++i)c[i].call(n,r)}(n,v,this,arguments[1]);break;case 3:!function(t,e,n,r,o){if(e)t.call(n,r,o);else for(var c=t.length,f=_t(t,c),i=0;i<c;++i)f[i].call(n,r,o)}(n,v,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,o,c){if(e)t.call(n,r,o,c);else for(var f=t.length,h=_t(t,f),i=0;i<f;++i)h[i].call(n,r,o,c)}(n,v,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];!function(t,e,n,r){if(e)t.apply(n,r);else for(var o=t.length,c=_t(t,o),i=0;i<o;++i)c[i].apply(n,r)}(n,v,this,o)}return!0},yt.prototype.addListener=function(t,e){return wt(this,t,e,!1)},yt.prototype.on=yt.prototype.addListener,yt.prototype.prependListener=function(t,e){return wt(this,t,e,!0)},yt.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,bt(this,t,e)),this},yt.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,bt(this,t,e)),this},yt.prototype.removeListener=function(t,e){var n,r,o,i,c;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener&&n.listener===e)0==--this._eventsCount?this._events=new gt:(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length;i-- >0;)if(n[i]===e||n[i].listener&&n[i].listener===e){c=n[i].listener,o=i;break}if(o<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new gt,this;delete r[t]}else!function(t,e){for(var i=e,n=i+1,r=t.length;n<r;i+=1,n+=1)t[i]=t[n];t.pop()}(n,o);r.removeListener&&this.emit("removeListener",t,c||e)}return this},yt.prototype.removeAllListeners=function(t){var e,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new gt,this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=new gt:delete n[t]),this;if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new gt,this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},yt.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(e):[]},yt.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):kt.call(t,e)},yt.prototype.listenerCount=kt,yt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Et=function t(e,n,r){w(this,t),this.bin=e,this.dat=n,this.type=r},xt={Application:1,Bootloader:2,Softdevice:4,SoftdeviceBootloader:8,Invalid:16,NotConfigured:32,NOT_IN_USE_1:64,NOT_IN_USE_2:128},At=function(){function t(e){if(w(this,t),null==e||"JSZip"===e.constructor.name)throw new Error("Firmware zip is invalid");this.type=xt.NotConfigured,this.zip=e,this.sections=[]}return _(t,[{key:"parseManifest",value:function(){var t=m(regeneratorRuntime.mark(function t(){var content,e,n,r,section,o,c,f,h,l,v,d,y,m;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.zip.file("manifest.json").async("string");case 2:if(content=t.sent,!(e=JSON.parse(content)).manifest.application){t.next=22;break}return t.prev=5,t.next=8,this.zip.file(e.manifest.application.bin_file).async("uint8Array");case 8:return n=t.sent,t.next=11,this.zip.file(e.manifest.application.dat_file).async("uint8Array");case 11:r=t.sent,section=new Et(n,r,xt.Application),this.sections.push(section),this.type=xt.Application,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(5),console.log(t.t0);case 20:t.next=77;break;case 22:if(!e.manifest.bootloader){t.next=40;break}return t.prev=23,t.next=26,this.zip.file(e.manifest.bootloader.bin_file).async("uint8array");case 26:return o=t.sent,t.next=29,this.zip.file(e.manifest.bootloader.dat_file).async("uint8array");case 29:c=t.sent,f=new Et(o,c,xt.Bootloader),this.sections.push(f),this.type=xt.Bootloader,t.next=38;break;case 35:t.prev=35,t.t1=t.catch(23),console.log("WWFirmwareUpdate.parseManifest bootloader "+t.t1);case 38:t.next=77;break;case 40:if(!e.manifest.softdevice){t.next=58;break}return t.prev=41,t.next=44,this.zip.file(e.manifest.softdevice.bin_file).async("uint8array");case 44:return h=t.sent,t.next=47,this.zip.file(e.manifest.softdevice.dat_file).async("uint8array");case 47:l=t.sent,v=new Et(h,l,xt.Application),this.sections.push(v),this.type=xt.Softdevice,t.next=56;break;case 53:t.prev=53,t.t2=t.catch(41),console.log("WWFirmwareUpdate.parseManifest softdevice "+t.t2);case 56:t.next=77;break;case 58:if(!e.manifest.softdevice_bootloader){t.next=76;break}return t.prev=59,t.next=62,this.zip.file(e.manifest.softdevice_bootloader.bin_file).async("uint8array");case 62:return d=t.sent,t.next=65,this.zip.file(e.manifest.softdevice_bootloader.dat_file).async("uint8array");case 65:y=t.sent,m=new Et(d,y,xt.SoftdeviceBootloader),this.sections.push(m),this.type=xt.SoftdeviceBootloader,t.next=74;break;case 71:t.prev=71,t.t3=t.catch(59),console.log("WWFirmwareUpdate.parseManifest softdevice & bootloader "+t.t3);case 74:t.next=77;break;case 76:this.type=xt.Invalid;case 77:return t.abrupt("return",this);case 78:case"end":return t.stop()}},t,this,[[5,17],[23,35],[41,53],[59,71]])}));return function(){return t.apply(this,arguments)}}()}]),t}(),Ct={Prepare:0,Transfer:1,Completed:2,Failed:3},Pt=1,St=2,Ot=3,Rt=4,It=6,Tt=96,Dt=1,Bt=function(){function t(e,n,r){w(this,t),this.opcode=r,this.buffer=n,this.characteristic=e}return _(t,null,[{key:"Worker",value:function(){var e=m(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n instanceof t!=!1){e.next=2;break}throw new Error("task not of type Task");case 2:if(r){e.next=4;break}throw new Error("onCompleition is not set");case 4:return e.prev=4,e.next=7,n.characteristic.writeValue(n.buffer);case 7:r(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),r("BLE Transfer Failed");case 14:case"end":return e.stop()}},e,null,[[4,10]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"verify",value:function(e,n){var r=new DataView(new ArrayBuffer(2));return r.setUint8(0,It),r.setUint8(1,e),new t(n,r.buffer,It)}},{key:"create",value:function(e,n,r){var o=new DataView(new ArrayBuffer(6));return o.setUint8(0,Pt),o.setUint8(1,e),o.setUint32(2,n,!0),new t(r,o.buffer,Pt)}},{key:"setPacketReturnNotification",value:function(e,n){var r=new DataView(new ArrayBuffer(3));return r.setUint8(0,St),r.setUint16(1,e,!0),new t(n,r.buffer,St)}},{key:"writePackage",value:function(e,n){return new t(n,e)}},{key:"checksum",value:function(e){var n=new DataView(new ArrayBuffer(1));return n.setUint8(0,Ot),new t(e,n.buffer,Ot)}},{key:"execute",value:function(e){var n=new DataView(new ArrayBuffer(1));return n.setUint8(0,Rt),new t(e,n.buffer,Rt)}}]),t}(),Ft=[],Ut=[],Lt="undefined"!=typeof Uint8Array?Uint8Array:Array,jt=!1;function Nt(){jt=!0;for(var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,t=code.length;i<t;++i)Ft[i]=code[i],Ut[code.charCodeAt(i)]=i;Ut["-".charCodeAt(0)]=62,Ut["_".charCodeAt(0)]=63}function Mt(t,e,n){for(var r,o,output=[],i=e;i<n;i+=3)r=(t[i]<<16)+(t[i+1]<<8)+t[i+2],output.push(Ft[(o=r)>>18&63]+Ft[o>>12&63]+Ft[o>>6&63]+Ft[63&o]);return output.join("")}function Yt(t){var e;jt||Nt();for(var n=t.length,r=n%3,output="",o=[],i=0,c=n-r;i<c;i+=16383)o.push(Mt(t,i,i+16383>c?c:i+16383));return 1===r?(e=t[n-1],output+=Ft[e>>2],output+=Ft[e<<4&63],output+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],output+=Ft[e>>10],output+=Ft[e>>4&63],output+=Ft[e<<2&63],output+="="),o.push(output),o.join("")}function zt(t,e,n,r,o){var c,f,h=8*o-r-1,l=(1<<h)-1,v=l>>1,d=-7,i=n?o-1:0,y=n?-1:1,s=t[e+i];for(i+=y,c=s&(1<<-d)-1,s>>=-d,d+=h;d>0;c=256*c+t[e+i],i+=y,d-=8);for(f=c&(1<<-d)-1,c>>=-d,d+=r;d>0;f=256*f+t[e+i],i+=y,d-=8);if(0===c)c=1-v;else{if(c===l)return f?NaN:1/0*(s?-1:1);f+=Math.pow(2,r),c-=v}return(s?-1:1)*f*Math.pow(2,c-r)}function $t(t,e,n,r,o,c){var f,h,l,v=8*c-o-1,d=(1<<v)-1,y=d>>1,rt=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,i=r?0:c-1,m=r?1:-1,s=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,f=d):(f=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-f))<1&&(f--,l*=2),(e+=f+y>=1?rt/l:rt*Math.pow(2,1-y))*l>=2&&(f++,l/=2),f+y>=d?(h=0,f=d):f+y>=1?(h=(e*l-1)*Math.pow(2,o),f+=y):(h=e*Math.pow(2,y-1)*Math.pow(2,o),f=0));o>=8;t[n+i]=255&h,i+=m,h/=256,o-=8);for(f=f<<o|h,v+=o;v>0;t[n+i]=255&f,i+=m,f/=256,v-=8);t[n+i-m]|=128*s}var Gt={}.toString,Vt=Array.isArray||function(t){return"[object Array]"==Gt.call(t)};function Wt(){return Jt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function qt(t,e){if(Wt()<e)throw new RangeError("Invalid typed array length");return Jt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Jt.prototype:(null===t&&(t=new Jt(e)),t.length=e),t}function Jt(t,e,n){if(!(Jt.TYPED_ARRAY_SUPPORT||this instanceof Jt))return new Jt(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return Zt(this,t)}return Ht(this,t,e,n)}function Ht(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);Jt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Jt.prototype:t=Kt(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!Jt.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|ee(e,n),o=(t=qt(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(te(e)){var n=0|Xt(e.length);return 0===(t=qt(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?qt(t,0):Kt(t,e);if("Buffer"===e.type&&Vt(e.data))return Kt(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function Qt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Zt(t,e){if(Qt(e),t=qt(t,e<0?0:0|Xt(e)),!Jt.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function Kt(t,e){var n=e.length<0?0:0|Xt(e.length);t=qt(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function Xt(t){if(t>=Wt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Wt().toString(16)+" bytes");return 0|t}function te(b){return!(null==b||!b._isBuffer)}function ee(t,e){if(te(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Pe(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Se(t).length;default:if(r)return Pe(t).length;e=(""+e).toLowerCase(),r=!0}}function ne(b,t,e){var i=b[t];b[t]=b[e],b[e]=i}function re(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=Jt.from(e,r)),te(e))return 0===e.length?-1:ie(t,e,n,r,o);if("number"==typeof e)return e&=255,Jt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):ie(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function ie(t,e,n,r,o){var i,c=1,f=t.length,h=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;c=2,f/=2,h/=2,n/=2}function l(t,i){return 1===c?t[i]:t.readUInt16BE(i*c)}if(o){var v=-1;for(i=n;i<f;i++)if(l(t,i)===l(e,-1===v?0:i-v)){if(-1===v&&(v=i),i-v+1===h)return v*c}else-1!==v&&(i-=i-v),v=-1}else for(n+h>f&&(n=f-h),i=n;i>=0;i--){for(var d=!0,y=0;y<h;y++)if(l(t,i+y)!==l(e,y)){d=!1;break}if(d)return i}return-1}function oe(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var c=e.length;if(c%2!=0)throw new TypeError("Invalid hex string");r>c/2&&(r=c/2);for(var i=0;i<r;++i){var f=parseInt(e.substr(2*i,2),16);if(isNaN(f))return i;t[n+i]=f}return i}function se(t,e,n,r){return Oe(Pe(e,t.length-n),t,n,r)}function ae(t,e,n,r){return Oe(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,n,r)}function ue(t,e,n,r){return ae(t,e,n,r)}function ce(t,e,n,r){return Oe(Se(e),t,n,r)}function fe(t,e,n,r){return Oe(function(t,e){for(var n,r,o,c=[],i=0;i<t.length&&!((e-=2)<0);++i)n=t.charCodeAt(i),r=n>>8,o=n%256,c.push(o),c.push(r);return c}(e,t.length-n),t,n,r)}function he(t,e,n){return 0===e&&n===t.length?Yt(t):Yt(t.slice(e,n))}function le(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,c,f,h,l=t[i],v=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=n)switch(d){case 1:l<128&&(v=l);break;case 2:128==(192&(o=t[i+1]))&&(h=(31&l)<<6|63&o)>127&&(v=h);break;case 3:o=t[i+1],c=t[i+2],128==(192&o)&&128==(192&c)&&(h=(15&l)<<12|(63&o)<<6|63&c)>2047&&(h<55296||h>57343)&&(v=h);break;case 4:o=t[i+1],c=t[i+2],f=t[i+3],128==(192&o)&&128==(192&c)&&128==(192&f)&&(h=(15&l)<<18|(63&o)<<12|(63&c)<<6|63&f)>65535&&h<1114112&&(v=h)}null===v?(v=65533,d=1):v>65535&&(v-=65536,r.push(v>>>10&1023|55296),v=56320|1023&v),r.push(v),i+=d}return function(t){var e=t.length;if(e<=ve)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=ve));return n}(r)}Jt.TYPED_ARRAY_SUPPORT=void 0===o.TYPED_ARRAY_SUPPORT||o.TYPED_ARRAY_SUPPORT,Jt.poolSize=8192,Jt._augment=function(t){return t.__proto__=Jt.prototype,t},Jt.from=function(t,e,n){return Ht(null,t,e,n)},Jt.TYPED_ARRAY_SUPPORT&&(Jt.prototype.__proto__=Uint8Array.prototype,Jt.__proto__=Uint8Array),Jt.alloc=function(t,e,n){return function(t,e,n,r){return Qt(e),e<=0?qt(t,e):void 0!==n?"string"==typeof r?qt(t,e).fill(n,r):qt(t,e).fill(n):qt(t,e)}(null,t,e,n)},Jt.allocUnsafe=function(t){return Zt(null,t)},Jt.allocUnsafeSlow=function(t){return Zt(null,t)},Jt.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Re(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Re(t.slice(0,0))}(t))},Jt.compare=function(a,b){if(!te(a)||!te(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var t=a.length,e=b.length,i=0,n=Math.min(t,e);i<n;++i)if(a[i]!==b[i]){t=a[i],e=b[i];break}return t<e?-1:e<t?1:0},Jt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Jt.concat=function(t,e){if(!Vt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Jt.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=Jt.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var o=t[i];if(!te(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},Jt.byteLength=ee,Jt.prototype._isBuffer=!0,Jt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<t;i+=2)ne(this,i,i+1);return this},Jt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<t;i+=4)ne(this,i,i+3),ne(this,i+1,i+2);return this},Jt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<t;i+=8)ne(this,i,i+7),ne(this,i+1,i+6),ne(this,i+2,i+5),ne(this,i+3,i+4);return this},Jt.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?le(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return ge(this,e,n);case"utf8":case"utf-8":return le(this,e,n);case"ascii":return pe(this,e,n);case"latin1":case"binary":return de(this,e,n);case"base64":return he(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},Jt.prototype.equals=function(b){if(!te(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Jt.compare(this,b)},Jt.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},Jt.prototype.compare=function(t,e,n,r,o){if(!te(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var c=(o>>>=0)-(r>>>=0),f=(n>>>=0)-(e>>>=0),h=Math.min(c,f),l=this.slice(r,o),v=t.slice(e,n),i=0;i<h;++i)if(l[i]!==v[i]){c=l[i],f=v[i];break}return c<f?-1:f<c?1:0},Jt.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},Jt.prototype.indexOf=function(t,e,n){return re(this,t,e,n,!0)},Jt.prototype.lastIndexOf=function(t,e,n){return re(this,t,e,n,!1)},Jt.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var c=!1;;)switch(r){case"hex":return oe(this,t,e,n);case"utf8":case"utf-8":return se(this,t,e,n);case"ascii":return ae(this,t,e,n);case"latin1":case"binary":return ue(this,t,e,n);case"base64":return ce(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,t,e,n);default:if(c)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),c=!0}},Jt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ve=4096;function pe(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function de(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function ge(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=Ce(t[i]);return o}function ye(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function me(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function we(t,e,n,r,o,c){if(!te(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<c)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function be(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function ke(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function _e(t,e,n,r,o,c){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Ee(t,e,n,r,o){return o||_e(t,0,n,4),$t(t,e,n,r,23,4),n+4}function xe(t,e,n,r,o){return o||_e(t,0,n,8),$t(t,e,n,r,52,8),n+8}Jt.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),Jt.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=Jt.prototype;else{var o=e-t;n=new Jt(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},Jt.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||me(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},Jt.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||me(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},Jt.prototype.readUInt8=function(t,e){return e||me(t,1,this.length),this[t]},Jt.prototype.readUInt16LE=function(t,e){return e||me(t,2,this.length),this[t]|this[t+1]<<8},Jt.prototype.readUInt16BE=function(t,e){return e||me(t,2,this.length),this[t]<<8|this[t+1]},Jt.prototype.readUInt32LE=function(t,e){return e||me(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Jt.prototype.readUInt32BE=function(t,e){return e||me(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Jt.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||me(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},Jt.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||me(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},Jt.prototype.readInt8=function(t,e){return e||me(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Jt.prototype.readInt16LE=function(t,e){e||me(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},Jt.prototype.readInt16BE=function(t,e){e||me(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},Jt.prototype.readInt32LE=function(t,e){return e||me(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Jt.prototype.readInt32BE=function(t,e){return e||me(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Jt.prototype.readFloatLE=function(t,e){return e||me(t,4,this.length),zt(this,t,!0,23,4)},Jt.prototype.readFloatBE=function(t,e){return e||me(t,4,this.length),zt(this,t,!1,23,4)},Jt.prototype.readDoubleLE=function(t,e){return e||me(t,8,this.length),zt(this,t,!0,52,8)},Jt.prototype.readDoubleBE=function(t,e){return e||me(t,8,this.length),zt(this,t,!1,52,8)},Jt.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||we(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},Jt.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||we(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},Jt.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,1,255,0),Jt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Jt.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,2,65535,0),Jt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):be(this,t,e,!0),e+2},Jt.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,2,65535,0),Jt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):be(this,t,e,!1),e+2},Jt.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,4,4294967295,0),Jt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):ke(this,t,e,!0),e+4},Jt.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,4,4294967295,0),Jt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):ke(this,t,e,!1),e+4},Jt.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);we(this,t,e,n,o-1,-o)}var i=0,c=1,sub=0;for(this[e]=255&t;++i<n&&(c*=256);)t<0&&0===sub&&0!==this[e+i-1]&&(sub=1),this[e+i]=(t/c>>0)-sub&255;return e+n},Jt.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);we(this,t,e,n,o-1,-o)}var i=n-1,c=1,sub=0;for(this[e+i]=255&t;--i>=0&&(c*=256);)t<0&&0===sub&&0!==this[e+i+1]&&(sub=1),this[e+i]=(t/c>>0)-sub&255;return e+n},Jt.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,1,127,-128),Jt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Jt.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,2,32767,-32768),Jt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):be(this,t,e,!0),e+2},Jt.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,2,32767,-32768),Jt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):be(this,t,e,!1),e+2},Jt.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,4,2147483647,-2147483648),Jt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):ke(this,t,e,!0),e+4},Jt.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||we(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Jt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):ke(this,t,e,!1),e+4},Jt.prototype.writeFloatLE=function(t,e,n){return Ee(this,t,e,!0,n)},Jt.prototype.writeFloatBE=function(t,e,n){return Ee(this,t,e,!1,n)},Jt.prototype.writeDoubleLE=function(t,e,n){return xe(this,t,e,!0,n)},Jt.prototype.writeDoubleBE=function(t,e,n){return xe(this,t,e,!1,n)},Jt.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!Jt.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},Jt.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var code=t.charCodeAt(0);code<256&&(t=code)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Jt.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var o=te(t)?t:Pe(new Jt(t,r).toString()),c=o.length;for(i=0;i<n-e;++i)this[i+e]=o[i%c]}return this};var Ae=/[^+\/0-9A-Za-z-_]/g;function Ce(t){return t<16?"0"+t.toString(16):t.toString(16)}function Pe(t,e){var n;e=e||1/0;for(var r=t.length,o=null,c=[],i=0;i<r;++i){if((n=t.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&c.push(239,191,189);continue}if(i+1===r){(e-=3)>-1&&c.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&c.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&c.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;c.push(n)}else if(n<2048){if((e-=2)<0)break;c.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;c.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;c.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return c}function Se(t){return function(t){var i,e,n,r,o,c;jt||Nt();var f=t.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===t[f-2]?2:"="===t[f-1]?1:0,c=new Lt(3*f/4-o),n=o>0?f-4:f;var h=0;for(i=0,e=0;i<n;i+=4,e+=3)r=Ut[t.charCodeAt(i)]<<18|Ut[t.charCodeAt(i+1)]<<12|Ut[t.charCodeAt(i+2)]<<6|Ut[t.charCodeAt(i+3)],c[h++]=r>>16&255,c[h++]=r>>8&255,c[h++]=255&r;return 2===o?(r=Ut[t.charCodeAt(i)]<<2|Ut[t.charCodeAt(i+1)]>>4,c[h++]=255&r):1===o&&(r=Ut[t.charCodeAt(i)]<<10|Ut[t.charCodeAt(i+1)]<<4|Ut[t.charCodeAt(i+2)]>>2,c[h++]=r>>8&255,c[h++]=255&r),c}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Ae,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Oe(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function Re(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Ie=Jt.from&&Jt.alloc&&Jt.allocUnsafe&&Jt.allocUnsafeSlow?Jt.from:function(t){return new Jt(t)};function Te(t,e){var n=function(t,n){return e(t,n)>>>0};return n.signed=e,n.unsigned=n,n.model=t,n}var De=Te("crc1",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=~~e,r=0,o=0;o<t.length;o++){r+=t[o]}return(n+=r%256)%256}),Be=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];"undefined"!=typeof Int32Array&&(Be=new Int32Array(Be));var Fe=Te("crc-8",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=~~e,r=0;r<t.length;r++){var o=t[r];n=255&Be[255&(n^o)]}return n}),Ue=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];"undefined"!=typeof Int32Array&&(Ue=new Int32Array(Ue));var Le=Te("dallas-1-wire",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=~~e,r=0;r<t.length;r++){var o=t[r];n=255&Ue[255&(n^o)]}return n}),je=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(je=new Int32Array(je));var Ne=Te("crc-16",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=~~e,r=0;r<t.length;r++){var o=t[r];n=65535&(je[255&(n^o)]^n>>8)}return n}),Me=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];"undefined"!=typeof Int32Array&&(Me=new Int32Array(Me));var Ye=Te("ccitt",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=void 0!==e?~~e:65535,r=0;r<t.length;r++){var o=t[r];n=65535&(Me[255&(n>>8^o)]^n<<8)}return n}),ze=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(ze=new Int32Array(ze));var $e=Te("crc-16-modbus",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=void 0!==e?~~e:65535,r=0;r<t.length;r++){var o=t[r];n=65535&(ze[255&(n^o)]^n>>8)}return n}),Ge=Te("xmodem",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=void 0!==e?~~e:0,r=0;r<t.length;r++){var code=n>>>8&255;code^=255&t[r],n=n<<8&65535,n^=code^=code>>>4,n^=code=code<<5&65535,n^=code=code<<7&65535}return n}),Ve=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];"undefined"!=typeof Int32Array&&(Ve=new Int32Array(Ve));var We=Te("kermit",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=void 0!==e?~~e:0,r=0;r<t.length;r++){var o=t[r];n=65535&(Ve[255&(n^o)]^n>>8)}return n}),qe=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];"undefined"!=typeof Int32Array&&(qe=new Int32Array(qe));var Je=Te("crc-24",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=void 0!==e?~~e:11994318,r=0;r<t.length;r++){var o=t[r];n=16777215&(qe[255&(n>>16^o)]^n<<8)}return n}),He=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(He=new Int32Array(He));var Qe=Te("crc-32",function(t,e){Jt.isBuffer(t)||(t=Ie(t));for(var n=0===e?0:-1^~~e,r=0;r<t.length;r++){var o=t[r];n=He[255&(n^o)]^n>>>8}return-1^n}),Ze=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(Ze=new Int32Array(Ze));var Ke={crc1:De,crc8:Fe,crc81wire:Le,crc16:Ne,crc16ccitt:Ye,crc16modbus:$e,crc16xmodem:Ge,crc16kermit:We,crc24:Je,crc32:Qe,crcjam:Te("jam",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Jt.isBuffer(t)||(t=Ie(t));for(var n=0===e?0:~~e,r=0;r<t.length;r++){var o=t[r];n=Ze[255&(n^o)]^n>>>8}return n})},Xe={NotStarted:1,Creating:2,Transfering:3,Storing:4,Completed:5,Failed:6},tn=Symbol(),en=Symbol(),nn=Symbol(),rn=Symbol(),on=Symbol(),sn=Symbol(),an=Symbol(),un=function(t){function e(t,n,r,o){var c;return w(this,e),(c=C(this,x(e).call(this)))[rn]=r,c[nn]=t,c[tn]=n,c[en]=o,c[on]=Xe.NotStarted,c[sn]=vt(Bt.Worker,1),c[an]={completed:0,size:n},c}return E(e,yt),_(e,[{key:"addTask",value:function(t){var e=this;if(t instanceof Bt==!1)throw new Error("task is not of type Task");this.taskQueue.push(t,function(n){return e.onTaskComplete(n,t)})}},{key:"onTaskComplete",value:function(t,e){if(t)this.taskQueue.kill(),this.state=Xe.Failed;else if(null==e.opcode){var n=this.progress.completed+e.buffer.byteLength;this.progress={completed:n,size:this.length}}}},{key:"toPackets",value:function(t){this.chunks=[];for(var e=this.offset+this.length,n=this.offset+t;n<e;){var r=n,o=r+20<e?r+20:r+(e-n),c=this.transfer.file.slice(r,o);this.chunks.push(c),n+=20}}},{key:"begin",value:function(){this.state=Xe.Creating,this.addTask(Bt.verify(this.type,this.transfer.controlPoint))}},{key:"verify",value:function(t){var e=t.getUint32(7,!0),n=t.getUint32(11,!0);this.validate(e,n)}},{key:"hasOffset",value:function(t){var e=this.offset,n=e+this.length;return t>=e&&t<=n}},{key:"validate",value:function(t,e){var n=Ke.crc32(this.transfer.file.slice(0,t));if(t===this.offset+this.length&&e===n){this.state=Xe.Storing;var r=Bt.execute(this.transfer.controlPoint);this.addTask(r)}else if(t===this.offset||t>this.offset+this.length||e!==n){this.state=Xe.Creating;var o=Bt.create(this.type,this.length,this.transfer.controlPoint);this.addTask(o)}else this.state=Xe.Transfering,this.toPackets(t),this.addTask(this.setPacketReturnNotification()),this.sendChuncks()}},{key:"sendChuncks",value:function(){for(var t=0;t<this.chunks.length;t++){var e=this.chunks[t].buffer;this.addTask(Bt.writePackage(e,this.transfer.packetPoint))}}},{key:"setPacketReturnNotification",value:function(){return Bt.setPacketReturnNotification(this.chunks.length,this.transfer.controlPoint)}},{key:"eventHandler",value:function(t){var e=t.getInt8(1),n=t.getInt8(2);switch(this.state){case Xe.Creating:e===It&&n===Dt?this.onSelect(t):e===Pt&&n===Dt?this.onCreate(t):e===St&&n===Dt?this.onPacketNotification(t):(this.state=Xe.Failed,console.warn("DFUObjectStates.Creating  Operation: "+e+" Result: "+n));break;case Xe.Transfering:e===Ot&&n===Dt?this.onChecksum(t):e===St&&n===Dt?this.onPacketNotification(t):(this.state=Xe.Failed,console.warn("DFUObjectStates.Transfering  Operation: "+e+" Result: "+n));break;case Xe.Storing:e===Rt&&n===Dt?this.onExecute():e===St&&n===Dt?this.onPacketNotification(t):(this.state=Xe.Failed,console.warn("DFUObjectStates.Storing  Operation: "+e+" Result: "+n))}}},{key:"onSelect",value:function(t){this.verify(t)}},{key:"onCreate",value:function(t){this.state=Xe.Transfering,this.toPackets(0),this.addTask(this.setPacketReturnNotification()),this.sendChuncks()}},{key:"onChecksum",value:function(t){var e=t.getUint32(3,!0),n=t.getUint32(7,!0);this.validate(e,n)}},{key:"onPacketNotification",value:function(t){}},{key:"onExecute",value:function(t){this.taskQueue.kill(),this.state=Xe.Completed}},{key:"length",get:function(){return this[tn]},set:function(t){this[tn]=t,this[an].size=t}},{key:"type",get:function(){return this[en]},set:function(t){this[en]=t}},{key:"offset",get:function(){return this[nn]},set:function(t){this[nn]=t}},{key:"transfer",get:function(){return this[rn]},set:function(t){this[rn]=t}},{key:"state",get:function(){return this[on]},set:function(t){this[on]!==t&&(this[on]=t,this.emit("stateChanged",{object:this,state:this[on]}))}},{key:"progress",get:function(){return this[an]},set:function(t){this[an]!==t&&(this[an]=t,this.emit("progressChanged",{object:this,state:this[on]}))}},{key:"taskQueue",get:function(){return this[sn]}}]),e}(),cn=Symbol(),fn=Symbol(),hn=Symbol(),ln=Symbol(),vn=Symbol(),pn=Symbol(),dn=Symbol(),gn=Symbol(),yn=function(t){function e(t,n,r,o){var c;return w(this,e),(c=C(this,x(e).call(this)))[fn]=Ct.Prepare,c[hn]=r,c[ln]=n,c[cn]=t,c[dn]=o,c[vn]=[],c[gn]=0,c}return E(e,yt),_(e,[{key:"file",get:function(){return this[cn]},set:function(t){this[cn]=t}},{key:"state",get:function(){return this[fn]},set:function(t){this[fn]!==t&&(this[fn]=t,this.emit("stateChanged",{transfer:this,state:this[fn]}))}},{key:"packetPoint",get:function(){return this[hn]},set:function(t){this[hn]=t}},{key:"controlPoint",get:function(){return this[ln]},set:function(t){this[ln]=t}},{key:"objects",get:function(){return this[vn]},set:function(t){this[vn]=t}},{key:"maximumObjectLength",get:function(){return this[pn]},set:function(t){this[pn]=t}},{key:"type",get:function(){return this[dn]},set:function(t){this[dn]=t}},{key:"progress",get:function(){return this[gn]},set:function(t){t!==this[gn]&&(this[gn]=t,this.emit("progressChanged",{transfer:this,progress:t}))}}]),_(e,[{key:"checkProgress",value:function(){switch(this.state){case Ct.Completed:case Ct.Failed:this.progress=1;break;case Ct.Transfer:var t=1/this.objects.length;this.progress=this.objects.reduce(function(e,n){switch(n.state){case Xe.Completed:case Xe.Failed:case Xe.Storing:return e+t;case Xe.Transfering:var r=n.progress.completed/n.progress.size;return e+t*r;default:return e}},0);break;default:this.progress=0}}},{key:"begin",value:function(){this.controlPoint.addEventListener("characteristicvaluechanged",this.onEvent.bind(this));var t=Bt.verify(this.type,this.controlPoint);Bt.Worker(t,function(){})}},{key:"end",value:function(){this.controlPoint.removeEventListener("characteristicvaluechanged",this.onEvent)}},{key:"prepareDFUObjects",value:function(t,e,n){this.maximumObjectLength=t,this.currentObjectIndex=0,this.generateObjects();var object=this.objects.find(function(t){return t.hasOffset(e)});object&&(this.currentObjectIndex=this.objects.indexOf(object)),this.state=Ct.Transfer,this.objects[this.currentObjectIndex].validate(e,n)}},{key:"generateObjects",value:function(){for(var t=this,e=this.file.length,n=0;n<e;){var r=n,o=r+this.maximumObjectLength<e?this.maximumObjectLength:e-n,object=new un(r,o,this,this.type);object.on("stateChanged",function(e){e.state===Xe.Failed?t.state=Ct.Failed:e.state===Xe.Completed&&t.nextObject()}),object.on("progressChanged",function(e){return t.checkProgress()}),this.objects.push(object),n+=this.maximumObjectLength}}},{key:"onEvent",value:function(t){var e=t.target.value;if(e&&e.getInt8(0)!==Tt)console.warn("Transfer.onEvent() opcode was not a response code");else switch(this.state){case Ct.Prepare:var n=e.getInt8(1),r=e.getInt8(2);if(n===It&&r===Dt){var o=e.getUint32(3,!0),c=e.getUint32(7,!0),f=e.getUint32(11,!0);this.prepareDFUObjects(o,c,f)}break;default:void 0!==this.objects&&void 0!==this.objects[this.currentObjectIndex]?(this.objects[this.currentObjectIndex].eventHandler(e),this.objects[this.currentObjectIndex].state===Xe.Failed&&(this.state,Ct.Failed)):this.state=Ct.Failed}}},{key:"nextObject",value:function(){this.currentObjectIndex<this.objects.length-1?(this.currentObjectIndex++,this.objects[this.currentObjectIndex].begin()):this.state=Ct.Completed}}]),e}(),mn=function(t,e){if(t instanceof yn==!1)throw new Error("task is not of type Task");if(!e)throw new Error("onCompleition is not set");t.on("stateChanged",function(n){n.state===Ct.Failed?(t.end(),e("transfer failed")):n.state===Ct.Completed&&(t.end(),e())}),t.begin()},wn=1,bn=2,kn={NOT_CONFIGURED:0,IDLE:1,TRANSFERING:2,COMPLETE:3,FAILED:4},_n=Symbol(),En=Symbol(),xn=Symbol(),An=Symbol(),Cn=Symbol(),Pn=Symbol(),Sn=function(t){function e(t,n){var r;return w(this,e),(r=C(this,x(e).call(this)))[En]=t,r[xn]=n,void 0!==r[En]&&void 0!==r[xn]?r[_n]=kn.IDLE:r[_n]=kn.NOT_CONFIGURED,r[An]=[],r[Cn]=vt(mn,1),r[Cn].error(r.onTransferError),r[Pn]={completed:0,size:1},r}return E(e,yt),_(e,[{key:"onTransferError",value:function(t,e){console.error(t)}},{key:"calculateProgress",value:function(){switch(this.state){case kn.NOT_CONFIGURED:case kn.IDLE:this[Pn].completed=0;break;case kn.COMPLETE:case kn.FAILED:this[Pn].completed=this[Pn].size;break;case kn.TRANSFERING:var progress=0,t=!0,e=!1,n=void 0;try{for(var r,o=this.transfers[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var c=r.value;switch(c.state){case Ct.Completed:progress+=c.file.length;case Ct.Transfer:progress+=c.file.length*c.progress;default:progress+=0}}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}this[Pn].completed=progress}this.emit("progressChanged",{dfuStateMachine:this,progress:this[Pn]})}},{key:"addTransfer",value:function(t){var e=this;this.transfers.push(t),this.queue.push(t,function(n){n||t.state===kn.FAILED?(e.queue.kill(),e.state=kn.FAILED):0===e.queue.length()&&(e.state=kn.COMPLETE)})}},{key:"sendFirmware",value:function(t){var e=this;if(this.state===kn.NOT_CONFIGURED)throw new Error("StateMachine is not configured with bluetooth characteristics");if(this.state!==kn.IDLE)throw new Error("Can only initate transfer when idle");if(t instanceof At==!1)throw new Error("Firmware needs to be of class Firmware");var n=function(t){e.calculateProgress()},r=0,o=!0,c=!1,f=void 0;try{for(var h,l=t.sections[Symbol.iterator]();!(o=(h=l.next()).done);o=!0){var section=h.value,v=new yn(section.dat,this.controlPoint,this.packetPoint,wn);v.on("progressChanged",n);var d=new yn(section.bin,this.controlPoint,this.packetPoint,bn);d.on("progressChanged",n),this.addTransfer(v),this.addTransfer(d),r+=section.dat.length,r+=section.bin.length}}catch(t){c=!0,f=t}finally{try{o||null==l.return||l.return()}finally{if(c)throw f}}this[Pn].completed=0,this[Pn].size=r,this.state=kn.TRANSFERING}},{key:"reset",value:function(){this.queue.kill(),this.state=kn.IDLE}},{key:"state",get:function(){return this[_n]},set:function(t){t!==this[_n]&&(this[_n]=t,this.emit("stateChanged",{dfuStateMachine:this,state:t}))}},{key:"controlPoint",get:function(){return this[En]},set:function(t){this[En]=t,this.state===kn.NOT_CONFIGURED&&null!=this[En]&&null!=this[xn]?this.state=kn.IDLE:this.state!==kn.IDLE||null!=this[En]&&null!=this[xn]||(this.state=kn.NOT_CONFIGURED)}},{key:"packetPoint",get:function(){return this[xn]},set:function(t){this[xn]=t,this.state===kn.NOT_CONFIGURED&&null!=this[En]&&null!=this[xn]?this.state=kn.IDLE:this.state!==kn.IDLE||null!=this[En]&&null!=this[xn]||(this.state=kn.NOT_CONFIGURED)}},{key:"transfers",get:function(){return this[An]}},{key:"progress",get:function(){return this[Pn]}},{key:"queue",get:function(){return this[Cn]}}]),e}(),On={data:function(){return{dfuFirmware:void 0,dfuStateMachine:new Sn,dfuState:kn.NOT_CONFIGURED,dfuProgress:0}},created:function(){this.dfuStateMachine.on("progressChanged",this.updateDFUProgress),this.dfuStateMachine.on("stateChanged",this.updateDFUState),this.dfuStateMachine.controlPoint=this.webBluetoothControlPoint,this.dfuStateMachine.packetPoint=this.webBluetoothPacketPoint},computed:{webBluetoothControlPoint:function(){throw new Error("DFUMixin expects component to provide computed property webBluetoothControlPoint")},webBluetoothPacketPoint:function(){throw new Error("DFUMixin expects component to provide computed property webBluetoothPacketPoint")},dfuIdle:function(){return this.dfuState===kn.IDLE},dfuInProgress:function(){return this.dfuState===kn.TRANSFERING},dfuCompleted:function(){return this.dfuState===kn.COMPLETE},dfuFailed:function(){return this.dfuState===kn.FAILED}},methods:{firmwareFromZip:function(){var t=m(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.dfuFirmware=new At(e),t.next=3,this.dfuFirmware.parseManifest();case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),resetDFU:function(){this.dfuStateMachine.reset()},performDFU:function(){this.dfuStateMachine.sendFirmware(this.dfuFirmware)},updateDFUState:function(t){this.dfuState=t.state},updateDFUProgress:function(t){var e=new Number(this.dfuStateMachine.progress.completed/this.dfuStateMachine.progress.size);this.dfuProgress=e.toFixed(2)}},watch:{webBluetoothPacketPoint:function(t){this.dfuStateMachine.packetPoint=t},webBluetoothControlPoint:function(t){this.dfuStateMachine.controlPoint=t}}},Rn="0001",In="0001",Tn="0002",Dn=function(t,e){var n=e.indexOf("xx"),r=e.substring(0,n)+t.substring(0,2)+e.substring(n+2,e.length);return n=r.indexOf("xx"),r=r.substring(0,n)+t.substring(2,4)+r.substring(n+2,r.length)},Bn={DFU:Dn("FE59","0000xxxx-0000-1000-8000-00805f9b34fb").toLowerCase(),Buttonless:Dn(Rn,"8E40xxxx-F315-4F60-9FB8-838830DAEA50").toLowerCase()},Fn={ControlPoint:Dn(In,"8ec9xxxx-f315-4f60-9fb8-838830daea50").toLowerCase(),PacketPoint:Dn(Tn,"8ec9xxxx-f315-4f60-9fb8-838830daea50").toLowerCase(),Buttonless:Dn(Rn,"8E40xxxx-F315-4F60-9FB8-838830DAEA50").toLowerCase()}}).call(this,n(89).setImmediate,n(118),n(19))},244:function(t,e){},246:function(t,e){},279:function(t,e,n){"use strict";n.r(e);n(64);var r=n(12),o={name:"BluetoothDeviceListEntry",props:{deviceId:{type:String,optional:!1,default:""}},data:function(){return{connectingAndDiscovering:!1}},computed:{device:function(){return this.$store.getters["webBluetooth/device"](this.deviceId)},bluetoothIconClasses:function(){return{icon:!0,"is-large":!0,"has-text-info":this.device&&this.device.gatt.connected}},deviceButtonClasses:function(){return{"is-loading":this.connectingAndDiscovering,button:!0,"is-outlined":!0}}},methods:{select:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.device.gatt.connected){t.next=4;break}this.$emit("connected-device-clicked",this.device.id),t.next=14;break;case 4:return this.connectingAndDiscovering=!0,t.prev=5,t.next=8,this.$store.dispatch("webBluetooth/connectDevice",{device:this.device});case 8:return t.next=10,this.$store.dispatch("webBluetooth/discoverServices",{device:this.device});case 10:this.$emit("connected-device-clicked",this.device.id);case 11:return t.prev=11,this.connectingAndDiscovering=!1,t.finish(11);case 14:case"end":return t.stop()}},t,this,[[5,,11,14]])}));return function(){return t.apply(this,arguments)}}(),remove:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("webBluetooth/removeDevice",{device:this.device});case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},c=n(10),f=Object(c.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticStyle:{"margin-bottom":"0.5rem"}},[n("div",{staticClass:"buttons"},[n("span",{staticClass:"button is-danger",on:{click:t.remove}},[n("i",{staticClass:"mdi mdi-window-close",attrs:{"aria-hidden":"true"}})]),t._v(" "),n("span",{class:t.deviceButtonClasses,on:{click:t.select}},[n("span",{class:t.bluetoothIconClasses},[n("i",{staticClass:"mdi mdi-24px mdi-bluetooth-connect",attrs:{"aria-hidden":"true"}})]),t._v(" "),n("span",[t._v("\n        "+t._s(t.device.name)+"\n      ")])])])])},[],!1,null,null,null).exports,h=n(192),l={name:"BluetoothDeviceList",components:{DeviceEntry:f},computed:{devices:function(){return this.$store.state.webBluetooth.devices}},methods:{addDeviceClicked:function(t){var e={anyDevices:!0,services:[h.b.DFU,"device_information"]};this.$store.dispatch("webBluetooth/addDevice",e)}}},v=Object(c.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("p",{staticClass:"title has-text-centered"},[t._v("\n    Bluetooth Devices\n  ")]),t._v(" "),n("ul",{},t._l(t.devices,function(e){return n("DeviceEntry",{key:e.id,attrs:{"device-id":e.id},on:{"connected-device-clicked":function(n){return t.$emit("device-picked-from-list",e.id)}}})}),1),t._v(" "),n("button",{staticClass:"button is-outlined is-fullwidth",on:{click:t.addDeviceClicked}},[t._v("\n    Connect Device\n  ")])])},[],!1,null,null,null).exports,d=n(39),y=(n(41),n(239)),m=n.n(y),w={name:"DeviceFirmwareUpdate",mixins:[h.d,d.a],props:{service:{required:!0,validator:function(t){return"BluetoothRemoteGATTService"===t.constructor.name}}},data:function(){return{fileName:""}},computed:{webBluetoothPacketPoint:function(){return this.$store.getters["webBluetooth/characteristicForService"](this.service,h.a.PacketPoint)},webBluetoothControlPoint:function(){return this.$store.getters["webBluetooth/characteristicForService"](this.service,h.a.ControlPoint)}},methods:{processFile:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.target.files,t.prev=1,r=new m.a,t.next=5,r.loadAsync(n[0]);case 5:return t.next=7,this.firmwareFromZip(r);case 7:this.fileName=n[0].name,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(t.t0);case 13:case"end":return t.stop()}},t,this,[[1,10]])}));return function(e){return t.apply(this,arguments)}}(),upload:function(){this.dfuFirmware instanceof h.c&&this.performDFU()},cancel:function(){this.resetDFU()}}},k=Object(c.a)(w,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.dfuIdle?n("div",[n("label",{staticClass:"file-label has-name is-fullwidth"},[n("input",{staticClass:"file-input",attrs:{type:"file",name:"resume"},on:{change:t.processFile}}),t._v(" "),t._m(0),t._v(" "),""!=t.fileName?n("span",{staticClass:"file-name"},[t._v("\n        "+t._s(t.fileName)+"\n      ")]):t._e()]),t._v(" "),n("a",{staticClass:"button is-primary",staticStyle:{"margin-top":"0.5rem"},on:{click:t.upload}},[t._v("\n      Update Device\n    ")])]):t._e(),t._v(" "),t.dfuInProgress?n("div",{staticClass:"columns is-vcentered"},[n("div",{staticClass:"column auto"},[n("progress",{staticClass:"progress is-primary",attrs:{max:"1.0"},domProps:{value:t.dfuProgress}})]),t._v(" "),n("div",{staticClass:"column is-one-third has-text-centered"},[n("a",{staticClass:"button is-danger",staticStyle:{"margin-top":"0.5rem"},on:{click:t.cancel}},[t._v("\n        Cancel\n      ")])])]):t._e(),t._v(" "),t.dfuFailed?n("div",{staticClass:"columns is-vcentered"},[t._m(1),t._v(" "),n("div",{staticClass:"column is-one-third has-text-centered"},[n("b-button",{attrs:{type:"is-danger"},on:{click:t.cancel}},[t._v("Try Again")])],1)]):t._e()])},[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"file-cta"},[e("span",{staticClass:"file-icon"},[e("i",{staticClass:"mdi mdi-upload"})]),this._v(" "),e("span",{staticClass:"file-label"},[this._v("\n          Pick DFU Package\n        ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"column auto"},[e("p",{staticClass:"has-text-danger"},[this._v("Device Firmware Update failed")])])}],!1,null,null,null).exports,_={name:"FormField",props:{label:{type:String,default:"Label"},text:{type:String,default:"value"}}},E={name:"DeviceInformation",components:{FormField:Object(c.a)(_,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field is-horizontal"},[e("div",{staticClass:"field-label is-small"},[e("label",{staticClass:"label"},[this._v(this._s(this.label))])]),this._v(" "),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("p",{staticClass:"control has-icons-left"},[e("input",{staticClass:"input is-small",attrs:{type:"text",readonly:""},domProps:{value:this.text}}),this._v(" "),this._m(0)])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"icon is-small is-left"},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true"}})])}],!1,null,null,null).exports},mixins:[d.a],props:{service:{required:!0,validator:function(t){return"BluetoothRemoteGATTService"===t.constructor.name}}},computed:{softwareRevision:function(){var t=this.$store.getters["webBluetooth/characteristicForService"](this.service,this.deviceInformationService.SoftwareRevision.uuid);return t?this.stringForCharacteristicValue(t.value):""},hardwareRevision:function(){var t=this.$store.getters["webBluetooth/characteristicForService"](this.service,this.deviceInformationService.HardwareRevision.uuid);return t?this.stringForCharacteristicValue(t.value):""},firmwareRevision:function(){var t=this.$store.getters["webBluetooth/characteristicForService"](this.service,this.deviceInformationService.FirmwareRevision.uuid);return t?this.stringForCharacteristicValue(t.value):""}}},x={name:"BluetoothServiceList",components:{DeviceFirmwareUpdate:k,DeviceInformation:Object(c.a)(E,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"columns"},[e("div",{staticClass:"column is-one-third"},[e("FormField",{attrs:{label:"Software",text:this.softwareRevision}})],1),this._v(" "),e("div",{staticClass:"column is-one-third"},[e("FormField",{attrs:{label:"Hardware",text:this.hardwareRevision}})],1),this._v(" "),e("div",{staticClass:"column is-one-third"},[e("FormField",{attrs:{label:"Firmware",text:this.firmwareRevision}})],1)])},[],!1,null,null,null).exports},mixins:[d.a],props:{deviceId:{type:String,required:!0,default:void 0}},computed:{device:function(){return this.$store.getters["webBluetooth/device"](this.deviceId)},disService:function(){return this.$store.getters["webBluetooth/serviceForDevice"](this.deviceId,this.deviceInformationService.uuid)},dfuService:function(){return this.$store.getters["webBluetooth/serviceForDevice"](this.deviceId,h.b.DFU)}}},A={name:"BluetoothView",components:{BluetoothList:v,BluetoothServices:Object(c.a)(x,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("p",{staticClass:"card-header-title"},[t._v(t._s(t.device.name))])]),t._v(" "),n("div",{staticClass:"card-content"},[t.disService?n("DeviceInformation",{attrs:{service:t.disService}}):t._e(),t._v(" "),t.dfuService?n("DeviceFirmwareUpdate",{attrs:{service:t.dfuService}}):t._e()],1)])},[],!1,null,null,null).exports},layout:"monsieur-dahlstrom",data:function(){return{currentDeviceID:void 0}},computed:{device:function(){return this.$store.getters["webBluetooth/device"](this.currentDeviceID)}},methods:{displayDevice:function(t){this.currentDeviceID=t}}},C=Object(c.a)(A,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tile is-ancestor"},[n("div",{staticClass:"tile is-parent is-5"},[n("div",{staticClass:"tile is-child"},[n("BluetoothList",{on:{"device-picked-from-list":t.displayDevice}})],1)]),t._v(" "),n("div",{staticClass:"tile is-parent is-7"},[n("div",{staticClass:"tile is-child"},[t.currentDeviceID&&t.device&&t.currentDeviceID===t.device.id&&t.device.gatt.connected?n("BluetoothServices",{attrs:{"device-id":t.currentDeviceID}}):t._e()],1)])])},[],!1,null,null,null);e.default=C.exports}}]);