{"version":3,"sources":["../../src/actions/write-actions.js"],"names":["MutationTypes","WriteActions","webBluetoothDFUScheduleWrite","write","dispatch","commit","Write","ADD_WRITE","webBluetoothDFUWriteRemove","REMOVE_WRITE","webBluetoothDFUExecuteWrite","attempts","characteristic","writeValue","buffer","state","Completed","error","Failed","UPDATE_WRITE"],"mappings":";;;;;;;;;;;;;;AAAA;;IAAYA,a;;AACZ;;;;AACA;;;;;;;;AAEA,IAAMC,eAAe;AAEbC,8BAFa;AAAA,kGAEsCC,KAFtC;AAAA,UAEkBC,QAFlB,QAEkBA,QAFlB;AAAA,UAE4BC,MAF5B,QAE4BA,MAF5B;AAAA;AAAA;AAAA;AAAA;AAGjB,kBAAGF,iBAAiB,gBAAMG,KAA1B,EAAiC;AAC/BD,uBAAOL,cAAcO,SAArB,EAAgCJ,KAAhC;AACD;;AALgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAQbK,4BARa;AAAA,oGAQqCL,KARrC;AAAA,UAQiBC,QARjB,SAQiBA,QARjB;AAAA,UAQ2BC,MAR3B,SAQ2BA,MAR3B;AAAA;AAAA;AAAA;AAAA;AASjB,kBAAGF,iBAAiB,gBAAMG,KAA1B,EAAiC;AAC/BD,uBAAOL,cAAcS,YAArB,EAAmCN,KAAnC;AACD;;AAXgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAcbO,6BAda;AAAA,oGAcsCP,KAdtC;AAAA,UAckBC,QAdlB,SAckBA,QAdlB;AAAA,UAc4BC,MAd5B,SAc4BA,MAd5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAedF,iBAAiB,gBAAMG,KAfT;AAAA;AAAA;AAAA;;AAgBXK,sBAhBW,GAgBA,CAhBA;;AAAA;AAAA;AAAA;AAAA,qBAmBLR,MAAMS,cAAN,CAAqBC,UAArB,CAAgCV,MAAMW,MAAtC,CAnBK;;AAAA;AAoBXH,yBAAW,CAAX;AACAR,oBAAMY,KAAN,GAAc,4BAAmBC,SAAjC;AArBW;AAAA;;AAAA;AAAA;AAAA;;AAuBXL;AACAR,oBAAMc,KAAN;AACAd,oBAAMY,KAAN,GAAc,4BAAmBG,MAAjC;;AAzBW;AAAA,kBA2BNP,WAAW,CA3BL;AAAA;AAAA;AAAA;;AAAA;AA4BfN,qBAAOL,cAAcmB,YAArB,EAAmChB,KAAnC;;AA5Be;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,CAArB;;kBAiCeF,Y","file":"write-actions.js","sourcesContent":["import * as MutationTypes from './../mutation-types'\r\nimport TransmissionStatus from './../models/transmission-types'\r\nimport Write from '../models/write'\r\n\r\nconst WriteActions = {\r\n\r\n  async webBluetoothDFUScheduleWrite({ dispatch, commit }, write) {\r\n    if(write instanceof Write.Write) {\r\n      commit(MutationTypes.ADD_WRITE, write)\r\n    }\r\n  },\r\n\r\n  async webBluetoothDFUWriteRemove ({ dispatch, commit }, write) {\r\n    if(write instanceof Write.Write) {\r\n      commit(MutationTypes.REMOVE_WRITE, write)\r\n    }\r\n  },\r\n\r\n  async webBluetoothDFUExecuteWrite ({ dispatch, commit }, write) {\r\n    if(write instanceof Write.Write) {\r\n      var attempts = 3;\r\n      do {\r\n        try {\r\n          await write.characteristic.writeValue(write.buffer)\r\n          attempts = 0\r\n          write.state = TransmissionStatus.Completed\r\n        } catch (err) {\r\n          attempts--\r\n          write.error = err\r\n          write.state = TransmissionStatus.Failed\r\n        }\r\n      } while (attempts > 0);\r\n      commit(MutationTypes.UPDATE_WRITE, write)\r\n    }\r\n  }\r\n}\r\n\r\nexport default WriteActions\r\n"]}